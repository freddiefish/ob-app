<ng-container *ngIf="decisionLocation?.id">

  <h1 mat-dialog-title>
    <ng-container *ngIf="otherDecisionsInThisLocation$ | async; let otherDecisionsInThisLocation">
      <button mat-icon-button
              *ngIf="otherDecisionsInThisLocation.length"
              [matMenuTriggerFor]="otherDecisions"
              [matMenuTriggerData]="{decisions: otherDecisionsInThisLocation}">
        <mat-icon>keyboard_arrow_down</mat-icon>
      </button>
    </ng-container>

    {{decision?.title}}
    <i style="cursor: pointer" (click)="closeModal();" class="material-icons close-button">close</i>
  </h1>

  <mat-dialog-content>
    <app-street-view [position]="{lat: decisionLocation.point.geopoint._lat, lng: decisionLocation.point.geopoint._long}"></app-street-view>

    <p style="text-align: right;">
      Date {{decision?.date | date: 'dd/MM/yyyy'}} <br>
      <a class="more-info-url"
         *ngIf="decision?.url"
         target="_blank"
         href="{{decision?.url}}">
        more info url <i class="material-icons">link</i>
      </a>
    </p>

    <!-- BACKGROUND -->
    <p style="font-weight: bold">Background</p>
    <app-read-more [content]="decision?.background"></app-read-more>

    <!-- HOW -->
    <p style="font-weight: bold">How</p>
    <app-read-more [content]="decision?.decision"></app-read-more>
  </mat-dialog-content>

</ng-container>

<mat-menu #otherDecisions="matMenu">
  <ng-template matMenuContent let-decisions="decisions">
    <p style=" padding-left: 0.5em; padding-right: 0.5em;">{{decisions?.length}} more decisions on this location:</p>
    <button *ngFor="let decision of decisions"
            mat-menu-item
            (click)="setDecision(decision)">

      {{decision.date | date}} {{decision.title}}

    </button>
  </ng-template>
</mat-menu>
