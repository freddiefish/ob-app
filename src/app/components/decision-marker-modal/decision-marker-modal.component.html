<ng-container *ngIf="decisionLocation?.id">

  <h1 mat-dialog-title>

    <ng-container *ngIf="decisionsInThisLocation$ | async; let decisionsInThisLocation">
      <button mat-icon-button
              *ngIf="decisionsInThisLocation?.length > 1"
              [matMenuTriggerFor]="otherDecisions"
              [matMenuTriggerData]="{decisions: decisionsInThisLocation}">
        <mat-icon>keyboard_arrow_down</mat-icon>
      </button>
    </ng-container>

  
    {{decision?.title | uppercase}}

    <i style="cursor: pointer" (click)="closeModal();" class="material-icons close-button">close</i>

  </h1>

   <!-- <p>item json pipe: {{decision | json}}</p> -->


    <app-street-view [position]="{lat: decisionLocation.point.geopoint._lat, lng: decisionLocation.point.geopoint._long}"></app-street-view>

    <ng-container *ngIf="decision">
      
      <p style="text-align: right;">
        {{ decision.status | uppercase }} <br>
        {{ decision.groupName }}<br>
        {{decision.date | date: 'dd/MM/yyyy'}} <br>
        <a class="more-info-url"
           *ngIf="decision.published"
           target="_blank"
           href="https://storage.cloud.google.com/ob-app-dev-252415.appspot.com/pubs/_besluit_{{decision.docId}}.pdf">
          full text <i class="material-icons">link</i>
        </a>
      </p>

      <div *ngIf="decision.financialStakeholders">
          <h3>Belanghebbenden</h3>
        <ul>
          <li *ngFor="let stakeHolder of decision.financialStakeholders">
              {{stakeHolder.Name}}, {{stakeHolder.JuridicalForm}} <a href="https://openthebox.be/company/{{stakeHolder.VAT}}" target="_blank"> <mat-icon> scatter_plot</mat-icon> </a> {{stakeHolder.Amount}} â‚¬
          </li>
        </ul>
      </div>
      <h3>Besluit</h3>
      <div *ngIf="decision.decision?.text">
          <p>{{decision.decision.text}}</p>
      </div>
      
      <div *ngFor="let h of decision.decision.headings">
        <h4>{{h.name}}</h4>
        <p>{{h.text}}</p>
      </div>

      <div *ngIf="decision.addenda">
          <h3>Bijlagen</h3>
        <ul>
          <li *ngFor="let addendum of decision.addenda">
            {{addendum}}
          </li>
        </ul>
      </div>

      <div *ngIf="decision.assocDocs">
          <h3>Gerelateerde besluiten</h3>
        <ul>
          <li *ngFor="let assocDoc of decision.assocDocs">
            {{assocDoc}}
          </li>
        </ul>
      </div>
      
    
    </ng-container>


</ng-container>



<mat-menu #otherDecisions="matMenu">

    <ng-template matMenuContent let-decisions="decisions">
  
      <p style=" padding-left: 0.5em; padding-right: 0.5em;">{{decisions?.length && decisions.length - 1}} meer besluiten{{decisions?.length > 2 ? 's' : ''}} op deze locatie:</p>
  
      <ng-container *ngFor="let item of decisions">
  
        <ng-container *ngIf="item.id !== decision.id">
  
          <button mat-menu-item
                  (click)="setDecision(item)">
  
            {{item.date | date}} {{item.title}}
  
          </button>
  
        </ng-container>
  
      </ng-container>
  
    </ng-template>
  
  </mat-menu>
  
  